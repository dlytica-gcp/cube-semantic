import{A as c}from"./AuthTokensStore-9401662d.js";const n=window.GRAPHQL_PLUS_SERVER_URL!==void 0?window.GRAPHQL_PLUS_SERVER_URL:"",a=async s=>{let o={};try{o=await s.json()}catch(i){return s.status===204?(console.log("HTTP status: ",s.status),{statusCode:s.status}):i}return o},d=async s=>{const o=await fetch(`${n}/auth/token/refresh?refresh_token=${s}`,{method:"GET",headers:{"Content-Type":"application/json"}});return await a(o)},T=()=>{const{refreshToken:s,accessToken:o,setAuthData:i}=c();return{login:async r=>{const t=await fetch(`${n}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,cookie:!1})}),e=await a(t);return e.error?{error:e.error,message:e.message}:(e!=null&&e.jwt_token&&(e!=null&&e.refresh_token)&&i({accessToken:e.jwt_token,refreshToken:e.refresh_token}),{magicLink:e==null?void 0:e.magicLink})},register:async r=>{const t=await fetch(`${n}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...r,cookie:!1})}),e=await a(t);if(e.error)return{error:e.error,message:e.message};i({accessToken:e.jwt_token,refreshToken:e.refresh_token})},logout:async()=>{const r=await fetch(`${n}/auth/logout?refresh_token=${s}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify({all:!0})}),t=await a(r);return t.error?{error:t.error,message:t.message}:t},changePass:async r=>{const t=await fetch(`${n}/auth/change-password`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(r)}),e=await a(t);return e.error?{error:e.error,message:e.message}:e},sendMagicLink:async({email:r})=>{const t=await fetch(`${n}/auth/register`,{method:"POST",body:JSON.stringify({email:r,cookie:!1}),headers:{Accept:"application/json","Content-Type":"application/json"}}),e=await a(t);return e.error?{error:e.error,message:e.message}:(i({accessToken:e.jwt_token,refreshToken:e.refresh_token}),e)}}};export{d as f,T as u};
