import{B as b,R as V,C as O,T as W}from"./index-2a334e56.js";import{C as I}from"./alertTypes-bd9943c7.js";import{c as Z,d as $,C as H,u as A,F as D,E as B,I as G}from"./index-f28b3217.js";import{j as e,c as d,S as J}from"./index-31f541c4.js";import{u as F}from"./index-d72c3122.js";import{j as P}from"./index-c0d2be16.js";import{u as z}from"./useTranslation-f1e31b7f.js";import{r as Y}from"./react-venders-3a9fd7ec.js";const q="_input_njpib_1",E={input:q},K=({value:l,onChange:o,placeholder:h,className:x})=>e.jsx(Z,{className:d(E.input,x),prefix:e.jsx(P,{className:E.inputIcon}),placeholder:h,onChange:_=>o(_.target.value),variant:"borderless",value:l}),Q="_header_a551j_1",U="_field_a551j_5",X="_table_a551j_15",ee="_column_a551j_18",se="_columns_a551j_22",p={header:Q,field:U,table:X,column:ee,columns:se},ne=({schema:l,path:o,control:h,initialValue:x,type:_})=>{const f=F(),{t:u}=z(["common"]),{field:{onChange:m,value:r}}=$({name:o,control:h,defaultValue:x}),w=()=>Object.keys(l[o]).every(t=>r[t]===!0),a=()=>{const t={};Object.keys(r).forEach(i=>t[i]=!1),m(t)},g=t=>{if(!t.target.checked)return a();const i={};Object.keys(l[o]).forEach(y=>i[y]=!0),m(i)};return e.jsxs("div",{children:[e.jsxs("div",{className:p.header,children:[e.jsx(H,{checked:w(),onChange:g,children:u("common:words.select_all")}),e.jsx(b,{onClick:a,type:"link",children:u("common:words.clear")})]}),Object.keys(l[o]).map(t=>e.jsx("div",{children:e.jsxs("div",{className:d(p.field),children:[e.jsx(H,{checked:r==null?void 0:r[t],onChange:i=>{m({...r,[t]:i.target.checked})},children:e.jsxs("span",{className:d(p.table,{[p.column]:!f.md}),children:[e.jsx("span",{children:t}),e.jsx("span",{className:p.separator,children:"â†’"}),e.jsxs("span",{children:[t,".",_]})]})}),e.jsxs("span",{className:d(p.columns,{[p.block]:!f.md}),children:["(",l[o][t].length,") ",u("common:words.columns")]})]})},t))]})},te=l=>e.jsx(e.Fragment,{children:e.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"15",fill:"none"},l,{children:e.jsx("path",{fill:"#470D69",d:"M14 .356c1.094 0 2 .906 2 2v10c0 1.125-.906 2-2 2H2c-1.125 0-2-.875-2-2v-10c0-1.094.875-2 2-2h12Zm0 2H2v2h12v-2Zm-12 10h2v-6H2v6Zm12-6H6v6h8v-6Z"})}))}),ce="_head_vstgx_1",oe="_dataSource_vstgx_4",le="_iconWrapper_vstgx_9",ae="_title_vstgx_22",re="_collapse_vstgx_26",ie="_collapseHeader_vstgx_29",de="_markupSelection_vstgx_34",me="_count_vstgx_37",pe="_separator_vstgx_40",ue="_block_vstgx_43",he="_formatSelection_vstgx_47",xe="_back_vstgx_50",_e="_submit_vstgx_56",je="_fullwidth_vstgx_60",fe="_link_vstgx_66",ge="_skip_vstgx_75",ke="_cetner_vstgx_78",n={head:ce,dataSource:oe,iconWrapper:le,title:ae,collapse:re,collapseHeader:ie,markupSelection:de,count:me,separator:pe,block:ue,formatSelection:he,back:xe,submit:_e,fullwidth:je,link:fe,skip:ge,cetner:ke},{Title:T,Text:ve}=W,{Panel:be}=I,we=[{label:"YAML",value:"yaml",disabled:!1},{label:"JS",value:"js",disabled:!1}],Ie=({dataSource:l,schema:o,onSubmit:h,onGoBack:x,onSkip:_,isGenerate:f=!1,isOnboarding:u=!1,initialValue:m={},loading:r=!1,resetOnSubmit:w=!1})=>{const{t:a}=z(["dataModelGeneration","common"]),{control:g,handleSubmit:t,watch:i,reset:y}=A({values:m}),k=F(),[S,L]=Y.useState(""),M=(s,c)=>s[c]?Object.keys(s[c]).filter(v=>{var j;return((j=s==null?void 0:s[c])==null?void 0:j[v])===!0}).length:0,R=(s,c)=>{h(s,c),w&&y()},C=o&&Object.keys(o).reduce((s,c)=>{if(c.toLowerCase().includes(S))s[c]=o[c];else{const v=Object.keys(o[c]).reduce((j,N)=>(N.toLowerCase().includes(S)&&(j[N]=o[c][N]),j),{});Object.keys(v).length>0&&(s[c]=v)}return s},{});return e.jsx("div",{className:n.wrapper,children:e.jsxs("div",{className:n.head,children:[e.jsxs("div",{className:n.dataSource,children:["icon"in l&&e.jsx("div",{className:n.iconWrapper,children:l.icon}),e.jsx(T,{className:n.title,level:3,children:l.name})]}),e.jsx(ve,{children:a("text")}),e.jsx(T,{level:5,children:a("title")}),e.jsx(K,{placeholder:a("common:words.find"),value:S,onChange:s=>L(s.toLowerCase())}),e.jsx(J,{spinning:r,children:e.jsxs(D,{id:"data-model-generation",children:[C?e.jsx(I,{className:n.collapse,expandIcon:()=>e.jsx(te,{}),children:Object.keys(C).map(s=>{const c=M(i(),s);return e.jsx(be,{className:n.collapse,header:e.jsxs("span",{className:n.collapseHeader,children:[s," ",c>0&&e.jsxs("span",{children:["(",c,")"]})]}),children:e.jsx(ne,{control:g,type:i("type"),schema:C,path:s,initialValue:m})},s)})}):e.jsx(B,{}),e.jsxs("div",{className:n.markupSelection,children:[e.jsx(T,{level:5,children:a("choose_markup")}),e.jsx(G,{control:g,name:"type",defaultValue:m.type||"yaml",fieldType:"radio",optionType:"button",options:we})]}),e.jsxs(V,{align:"middle",justify:"space-between",children:[e.jsxs(O,{xs:24,md:18,children:[(u||!f)&&e.jsx(b,{className:d(n.back,{[n.fullwidth]:!k.md}),size:"large",color:"primary",onClick:x,children:a("common:words.back")}),e.jsx(b,{className:d(n.submit,{[n.fullwidth]:!k.md}),type:"primary",size:"large",htmlType:"submit",loading:r,form:"data-model-generation",onClick:t(s=>R(s,s.type)),children:a("common:words.generate")})]}),u&&e.jsx(O,{xs:24,md:6,className:d(n.skip,{[n.center]:!k.md}),children:e.jsx(b,{className:d(n.link,{[n.fullwidth]:!k.md}),type:"link",onClick:_,children:a("common:words.skip")})})]})]})})]})})};export{Ie as D,K as S};
