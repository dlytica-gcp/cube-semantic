import{A as P}from"./index-d4c68e4d.js";import{u as x,F as g,I as c,S as C}from"./index-f28b3217.js";import{m as $}from"./index-4e5c896b.js";import{j as s}from"./index-31f541c4.js";import{R as y,C as p,B as d,T as u}from"./index-2a334e56.js";import{v as h}from"./validations-55614028.js";import{u as i}from"./useTranslation-f1e31b7f.js";import{C as k,I as F}from"./CurrentUserStore-886fe293.js";import{u as z}from"./useAuth-c4a8cfeb.js";import{u as A}from"./useCheckResponse-471c00b7.js";import{u as L}from"./useLocation-795e9ebc.js";import{A as M}from"./AuthTokensStore-9401662d.js";import{S as R}from"./paths-1d44e380.js";import{r as q}from"./react-venders-3a9fd7ec.js";import"./button-255d95e9.js";import"./dayjs.min-e1e47a26.js";import"./formatTime-900939d2.js";import"./tslib.es6-5f87f175.js";import"./urql.es-e4ed66a8.js";import"./index-801816c4.js";const E="_title_159in_1",B={title:E},{Title:G}=u,U=({initialValue:e,onSubmit:r})=>{const{t:o}=i(["settings","common"]),{control:n,handleSubmit:t}=x({values:e});return s.jsxs(g,{layout:"vertical",children:[s.jsx(G,{level:5,className:B.title,children:o("personal_info.general_info.title")}),s.jsxs(y,{gutter:[16,16],children:[s.jsx(p,{span:24,md:12,children:s.jsx(c,{control:n,rules:{required:!0},name:"displayName",label:o("common:form.labels.full_name"),defaultValue:e==null?void 0:e.displayName})}),s.jsx(p,{span:24,md:12,children:s.jsx(c,{label:o("common:form.labels.email"),placeholder:o("common:form.placeholders.email"),control:n,rules:{required:!0,validate:l=>h.email(l)||o("common:form.errors.email")},name:"email"})})]}),s.jsx(d,{htmlType:"submit",size:"large",type:"primary",onClick:t(r),children:o("personal_info.general_info.update")})]})},W="_title_1iygp_1",D="_btn_1iygp_6",_={title:W,btn:D},{Title:H}=u,J=({onSubmit:e=()=>{}})=>{const{t:r}=i(["settings"]);return s.jsxs("div",{children:[s.jsx(H,{className:_.title,level:5,children:r("personal_info.logout_sessions.title")}),s.jsx(d,{className:_.btn,type:"text",size:"large",onClick:e,children:r("personal_info.logout_sessions.logout")})]})},K="_title_1x1zb_1",O={title:K},{Title:Q}=u,X=({initialValue:e,onSubmit:r})=>{const{t:o}=i(["settings","common"]),{control:n,handleSubmit:t}=x({values:e});return s.jsxs(g,{layout:"vertical",children:[s.jsx(Q,{className:O.title,level:5,children:o("personal_info.security.title")}),s.jsxs(y,{gutter:[16,16],children:[s.jsx(p,{span:24,md:12,children:s.jsx(c,{control:n,name:"oldPassword",label:o("common:form.labels.old_password"),defaultValue:e==null?void 0:e.oldPassword,fieldType:"password"})}),s.jsx(p,{span:24,md:12,children:s.jsx(c,{control:n,rules:{required:!0,validate:l=>h.password(l)||o("common:form.errors.password")},name:"newPassword",label:o("common:form.labels.new_password"),defaultValue:e==null?void 0:e.newPassword,fieldType:"password"})})]}),s.jsx(d,{htmlType:"submit",size:"large",type:"primary",onClick:t(r),children:o("personal_info.security.update")})]})},Y="_wrapper_1mcv7_1",Z={wrapper:Y},V=({initialValue:e,error:r,onInfoSubmit:o=()=>{},onUpdatePassword:n=()=>{},onLogout:t=()=>{}})=>(i(["settings","pages"]),s.jsx(s.Fragment,{children:s.jsxs(C,{className:Z.wrapper,direction:"vertical",size:25,children:[r&&s.jsx(P,{type:"error",message:r}),s.jsx(U,{initialValue:e,onSubmit:o}),s.jsx(X,{onSubmit:n}),s.jsx(J,{onSubmit:t})]})})),js=()=>{const{t:e}=i(["settings","pages"]),{logout:r,changePass:o}=z(),[,n]=L(),{currentUser:t}=k(),{cleanTokens:l}=M(),[j,f]=q.useState(),[w,b]=F();A(w,()=>{},{successMessage:e("settings:personal_info.user_updated")});const v=m=>{b({user_id:t.id,email:m.email,display_name:m.displayName})},S=async m=>{const I={old_password:m.oldPassword,new_password:m.newPassword},a=await o(I);a.statusCode===204?(f(void 0),$.success(e("settings:personal_info.password_updated"))):f((a==null?void 0:a.message)||(a==null?void 0:a.error))},T=async()=>{await r(),l(),n(R)},N={displayName:(t==null?void 0:t.displayName)||"",email:(t==null?void 0:t.email)||""};return s.jsx(V,{error:j,initialValue:N,onInfoSubmit:v,onUpdatePassword:S,onLogout:T})};export{V as PersonalInfo,js as default};
